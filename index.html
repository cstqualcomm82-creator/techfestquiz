<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qualcomm CST Quiz</title>
    <link rel="icon" href="data:image/svg+xml,%3csvg viewBox='0 0 783.6 144' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M-125.7-125.7h1035v395.4h-1035z' fill='none'%3e%3c/path%3e%3cpath d='M211.5 41.3c2.1 0 3.9 1.7 3.9 3.9v74.5c0 2.1-1.9 3.8-3.9 3.8h-10.1c-1.9 0-3.8-1.5-3.8-3.6V113c-5.1 7.5-13.9 12.7-26.7 12.7-21.4 0-34.6-14.2-34.6-35.3V45c0-2.1 1.9-3.8 3.9-3.8h10.1c2.1 0 3.8 1.7 3.8 3.8v42.5c0 13.7 7.2 22.8 21.4 22.8 13.9 0 22.1-9.4 22.1-22.6V45c0-2.1 1.9-3.8 3.8-3.8h10.1M62.5 0C27.9 0 0 26.9 0 62.8c0 36 27.9 62.8 62.5 62.8 5.9 0 11.6-.8 17-2.3l6.8 17.5c.7 1.9 2.1 3.1 4.6 3.1h10.8c2.6 0 4.5-1.7 3.3-5L96.2 116c17.3-10.9 28.8-30.2 28.8-53.3C125 26.9 97.1 0 62.5 0m27.2 99.3l-7.9-20.5c-.7-1.7-2.1-3.3-5.1-3.3H66.4c-2.6 0-4.6 1.7-3.4 5l10.4 26.9c-3.4.9-7.1 1.3-10.9 1.3-25.3 0-43.3-19.9-43.3-45.9s18-45.9 43.3-45.9 43.3 19.9 43.3 45.9c0 15.2-6.1 28.2-16.1 36.5m693.6 20c.9 2.1-.2 4.1-2.7 4.1h-11.3c-2.1 0-3.8-1-4.5-3.1l-20.9-56.2-21.2 56.2c-.9 2.2-2.4 3.1-4.5 3.1h-10.1c-2.1 0-3.6-.9-4.5-3.1l-21.4-56.5-21.1 56.5c-.9 2.1-2.4 3.1-4.5 3.1H646c-2.1 0-3.6-1-4.5-3.1l-20.9-56.5-21.6 56.5c-.9 2.2-2.4 3.1-4.5 3.1h-10.1c-2.1 0-3.6-.9-4.5-3.1l-21.1-56.5-21.1 56.5c-.7 2.1-2.4 3.1-4.5 3.1h-11c-2.6 0-3.6-2.1-2.7-4.1l28.6-74.8c.9-2.2 2.4-3.3 4.5-3.3h12.3c2.1 0 3.6 1 4.5 3.3L590 99.1l20.4-54.6c.9-2.2 2.4-3.3 4.5-3.3H627c2.1 0 3.6 1 4.5 3.3l20.2 54.6 20.2-54.6c.9-2.2 2.4-3.3 4.5-3.3h12.2c2.1 0 3.6 1 4.5 3.3l20.5 54.6 20-54.6c.9-2.2 2.4-3.3 4.5-3.3h12.3c2.1 0 3.6 1 4.5 3.3l28.4 74.8m-473.9-78h-10.1c-2.1 0-3.9 1.7-3.9 3.9V52c-5.1-7.7-15.1-13.2-26.9-13.2-22.3 0-41.4 17.6-41.4 43.3 0 26 19.2 43.5 41.3 43.5 12 0 21.7-5.5 27.1-13.2v7.2c0 2.1 1.9 3.8 3.9 3.8h10.1c2.1 0 3.8-1.7 3.8-3.8V45.2c-.1-2.2-1.8-3.9-3.9-3.9m-39 67.9c-14.7 0-25.2-12-25.2-26.9 0-15.1 10.4-26.7 25.2-26.7 14.6 0 25.2 11.6 25.2 26.7-.1 15-10.7 26.9-25.2 26.9m159.5 2.6c2.2 2.7.3 4.8-.9 5.7-7 5.3-16.3 8.2-26.4 8.2-25.5 0-42.5-18.7-42.5-43.3s17-43.5 42.5-43.5c10.1 0 19.3 2.9 26.4 8.2 1.2.9 2.9 2.7.9 5.7l-4.8 6.7c-1.9 2.6-4.1 1.9-6 .7-4.5-2.7-9.8-5-15.9-5-14.9 0-24.8 12-24.8 27.2s9.9 27.1 24.8 27.1c6.2 0 11.1-2.4 15.6-5 1.9-1 3.9-1.9 6 .9l5.1 6.4zM477.5 39c-24 0-43.1 18.8-43.1 43.3 0 24.7 19.2 43.3 43.1 43.3 24 0 43.1-18.7 43.1-43.3.1-24.4-19.1-43.3-43.1-43.3m0 70.1c-14.7 0-25.2-11.8-25.2-26.7 0-15.1 10.4-26.7 25.2-26.7 14.7 0 25.2 11.6 25.2 26.7 0 14.9-10.4 26.7-25.2 26.7M344.8 2.2c2.2 0 3.8 1.9 3.8 3.9v113.4c0 2.1-1.5 3.9-3.8 3.9h-10.1c-2.1 0-3.9-1.9-3.9-3.9V6.2c0-2.1 1.9-3.9 3.9-3.9h10.1' fill='%233253DC'%3e%3c/path%3e%3c/svg%3e">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary-color: #3253DC;
            --primary-light: rgba(50, 83, 220, 0.1);
            --primary-medium: rgba(50, 83, 220, 0.5);
            --white: #FFFFFF;
            --light-gray: #F5F7FA;
            --medium-gray: #E1E5EE;
            --dark-gray: #6B7280;
            --text-color: #1F2937;
            --success-color: #10B981;
            --error-color: #EF4444;
            --bubble-color: rgba(50, 83, 220, 0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background-color: var(--white);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Bubble Animation Styles */
        .bubble-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
        }
        
        .bubble {
            position: absolute;
            border-radius: 50%;
            background: var(--bubble-color);
            animation: float linear infinite;
            opacity: 0;
        }
        
        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: var(--bubble-opacity);
            }
            90% {
                opacity: var(--bubble-opacity);
            }
            100% {
                transform: translateY(-100px) translateX(var(--bubble-drift));
                opacity: 0;
            }
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }
        
        .logo-container {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
        }
        
        .logo {
            width: 180px;
        }
        
        header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        h1 {
            font-weight: 700;
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        header p {
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            color: var(--dark-gray);
        }
        
        .card {
            background: var(--white);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .login-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        @media (min-width: 992px) {
            .login-container {
                flex-direction: row;
                align-items: stretch;
            }
            
            .form-container, .leaderboard-container {
                flex: 1;
            }
        }
        
        .card-heading {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--primary-color);
            font-weight: 600;
            position: relative;
            padding-bottom: 10px;
        }
        
        .card-heading::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--primary-color);
            border-radius: 2px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
            font-size: 0.95rem;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 15px;
            background: var(--white);
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input::placeholder {
            color: var(--dark-gray);
            opacity: 0.8;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(50, 83, 220, 0.2);
        }
        
        .form-input.error {
            border-color: var(--error-color);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.2);
        }
        
        .error-message {
            color: var(--error-color);
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .btn {
            padding: 12px 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(50, 83, 220, 0.3);
        }
        
        .btn:hover {
            background: #2845c7;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(50, 83, 220, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn:disabled {
            background: var(--medium-gray);
            color: var(--dark-gray);
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .btn-link {
            display: inline-block;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-link:hover {
            color: #2845c7;
            text-decoration: underline;
        }
        
        #start-btn {
            width: 100%;
            margin-top: 10px;
        }
        
        .leaderboard-table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        .modern-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            color: var(--text-color);
        }
        
        .modern-table th,
        .modern-table td {
            padding: 12px 15px;
            text-align: left;
        }
        
        .modern-table th {
            background: var(--light-gray);
            color: var(--text-color);
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .modern-table th:first-child {
            border-top-left-radius: 8px;
        }
        
        .modern-table th:last-child {
            border-top-right-radius: 8px;
        }
        
        .modern-table tbody tr {
            transition: all 0.3s ease;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .modern-table tbody tr:last-child {
            border-bottom: none;
        }
        
        .modern-table tbody tr:hover {
            background: var(--primary-light);
        }
        
        .modern-table .top-score {
            background: rgba(16, 185, 129, 0.05);
        }
        
        .modern-table .top-score td:first-child {
            position: relative;
        }
        
        .modern-table .top-score td:first-child::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--success-color);
        }
        
        .no-data-message {
            text-align: center;
            padding: 20px;
            color: var(--dark-gray);
            font-style: italic;
        }
        
        .progress-container {
            margin-bottom: 30px;
        }
        
        .progress-bar {
            height: 6px;
            background: var(--medium-gray);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.5s cubic-bezier(0.22, 1, 0.36, 1);
        }
        
        #question-counter {
            text-align: right;
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--dark-gray);
        }

        #confetti-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }

        
        .question-container {
            background: var(--light-gray);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
        }
        
        .question {
            font-size: 1.3rem;
            font-weight: 500;
            margin-bottom: 20px;
            color: var(--text-color);
            position: relative;
            padding-left: 15px;
        }
        
        .question::before {
            content: '';
            position: absolute;
            left: 0;
            top: 5px;
            bottom: 5px;
            width: 3px;
            background: var(--primary-color);
            border-radius: 3px;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .options {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .option {
            padding: 15px 20px;
            background: var(--white);
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-size: 1rem;
            color: var(--text-color);
        }
        
        .option:hover {
            background: var(--primary-light);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        
        .option.selected {
            background: var(--primary-light);
            border-color: var(--primary-color);
            box-shadow: 0 0 0 1px var(--primary-color);
        }
        
        .option.correct {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--success-color);
        }
        
        .option.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--error-color);
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .user-info {
            background: var(--primary-light);
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .user-info strong {
            color: var(--primary-color);
        }
        
        .result-container {
            text-align: center;
        }
        
        .score {
            font-size: 3rem;
            font-weight: bold;
            margin: 30px 0;
            color: var(--primary-color);
        }
        
        .message {
            font-size: 1.3rem;
            margin-bottom: 30px;
            color: var(--text-color);
        }
        
        .history-container {
            margin: 40px 0;
        }
        
        .history-container h3 {
            margin-bottom: 20px;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .card {
                padding: 20px;
            }
            
            .btn {
                padding: 12px 20px;
            }
            
            .question {
                font-size: 1.1rem;
            }
            
            .score {
                font-size: 2.5rem;
            }

            .result-container .controls {
                flex-direction: column;
                gap: 15px;
            }
        }

        /* Theme Switcher */
        .theme-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
        }

        #theme-toggle {
            background: var(--light-gray);
            border: 1px solid var(--medium-gray);
            color: var(--text-color);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        #theme-toggle:hover {
            background: var(--medium-gray);
        }

        .sun-and-moon {
            transform-origin: center center;
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        html[data-theme='dark'] .sun-and-moon {
            transform: rotate(180deg);
        }

        /* Loader Styles */
        .loader {
            width: 48px;
            height: 48px;
            border: 3px solid var(--text-color);
            border-radius: 50%;
            display: block;
            position: relative;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
            margin: 40px auto;
        }
        .loader::after {
            content: '';  
            box-sizing: border-box;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid;
            border-color: var(--primary-color) transparent;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        } 

        html[data-theme='dark'] {
            --primary-color: #527BFF;
            --primary-light: rgba(82, 123, 255, 0.1);
            --primary-medium: rgba(82, 123, 255, 0.5);
            --white: #111827;
            --light-gray: #1F2937;
            --medium-gray: #374151;
            --dark-gray: #9CA3AF;
            --text-color: #F9FAFB;
            --bubble-color: rgba(82, 123, 255, 0.1);
        }

        html[data-theme='dark'] .card {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        }

        html[data-theme='dark'] .form-input {
            background: #1F2937;
        }

        html[data-theme='dark'] .form-input::placeholder {
            color: #6B7280;
        }

        html[data-theme='dark'] .modern-table th {
            background: #111827;
        }

        html[data-theme='dark'] .modern-table tbody tr {
            border-bottom: 1px solid #374151;
        }

        html[data-theme='dark'] .modern-table tbody tr:hover {
            background: rgba(82, 123, 255, 0.08);
        }

        html[data-theme='dark'] .modern-table .top-score {
            background: rgba(16, 185, 129, 0.05);
        }

        html[data-theme='dark'] .question-container {
            background: #111827;
        }

        html[data-theme='dark'] .option {
            background: #1F2937;
        }

        html[data-theme='dark'] .option:hover {
            background: rgba(82, 123, 255, 0.1);
            border-color: #527BFF;
        }

        html[data-theme='dark'] .option.selected {
            background: rgba(82, 123, 255, 0.1);
            border-color: #527BFF;
            box-shadow: 0 0 0 1px #527BFF;
        }

        html[data-theme='dark'] .user-info {
            background: rgba(82, 123, 255, 0.1);
        }
        
        html[data-theme='dark'] .btn:disabled {
            background: #374151;
            color: #9CA3AF;
        }

        html[data-theme='dark'] #theme-toggle {
            background: #1F2937;
            border: 1px solid #374151;
            color: #F9FAFB;
        }

        html[data-theme='dark'] #theme-toggle:hover {
            background: #374151;
        }

    </style>
</head>
<body>
        <div class="bubble-container" id="bubble-container">
            <!-- Bubbles will be dynamically added here -->
        </div>

        <div class="theme-switcher">
            <button id="theme-toggle" title="Toggle theme">
                <svg class="sun-and-moon" aria-hidden="true" width="24" height="24" viewBox="0 0 24 24">
                    <mask class="moon" id="moon-mask">
                        <rect x="0" y="0" width="100%" height="100%" fill="white" />
                        <circle cx="24" cy="10" r="6" fill="black" />
                    </mask>
                    <circle class="sun" cx="12" cy="12" r="6" mask="url(#moon-mask)" fill="currentColor" />
                    <g class="sun-beams" stroke="currentColor">
                        <line x1="12" y1="1" x2="12" y2="3" />
                        <line x1="12" y1="21" x2="12" y2="23" />
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                        <line x1="1" y1="12" x2="3" y2="12" />
                        <line x1="21" y1="12" x2="23" y2="12" />
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                    </g>
                </svg>
            </button>
        </div>
    
    <div class="container">
        <div class="logo-container">
            <svg viewBox="0 0 783.6 144" xmlns="http://www.w3.org/2000/svg" class="logo" style="fill: var(--primary-color);"><path d="M-125.7-125.7h1035v395.4h-1035z" fill="none"></path><path d="M211.5 41.3c2.1 0 3.9 1.7 3.9 3.9v74.5c0 2.1-1.9 3.8-3.9 3.8h-10.1c-1.9 0-3.8-1.5-3.8-3.6V113c-5.1 7.5-13.9 12.7-26.7 12.7-21.4 0-34.6-14.2-34.6-35.3V45c0-2.1 1.9-3.8 3.9-3.8h10.1c2.1 0 3.8 1.7 3.8 3.8v42.5c0 13.7 7.2 22.8 21.4 22.8 13.9 0 22.1-9.4 22.1-22.6V45c0-2.1 1.9-3.8 3.8-3.8h10.1M62.5 0C27.9 0 0 26.9 0 62.8c0 36 27.9 62.8 62.5 62.8 5.9 0 11.6-.8 17-2.3l6.8 17.5c.7 1.9 2.1 3.1 4.6 3.1h10.8c2.6 0 4.5-1.7 3.3-5L96.2 116c17.3-10.9 28.8-30.2 28.8-53.3C125 26.9 97.1 0 62.5 0m27.2 99.3l-7.9-20.5c-.7-1.7-2.1-3.3-5.1-3.3H66.4c-2.6 0-4.6 1.7-3.4 5l10.4 26.9c-3.4.9-7.1 1.3-10.9 1.3-25.3 0-43.3-19.9-43.3-45.9s18-45.9 43.3-45.9 43.3 19.9 43.3 45.9c0 15.2-6.1 28.2-16.1 36.5m693.6 20c.9 2.1-.2 4.1-2.7 4.1h-11.3c-2.1 0-3.8-1-4.5-3.1l-20.9-56.2-21.2 56.2c-.9 2.2-2.4 3.1-4.5 3.1h-10.1c-2.1 0-3.6-.9-4.5-3.1l-21.4-56.5-21.1 56.5c-.9 2.1-2.4 3.1-4.5 3.1H646c-2.1 0-3.6-1-4.5-3.1l-20.9-56.5-21.6 56.5c-.9 2.2-2.4 3.1-4.5 3.1h-10.1c-2.1 0-3.6-.9-4.5-3.1l-21.1-56.5-21.1 56.5c-.7 2.1-2.4 3.1-4.5 3.1h-11c-2.6 0-3.6-2.1-2.7-4.1l28.6-74.8c.9-2.2 2.4-3.3 4.5-3.3h12.3c2.1 0 3.6 1 4.5 3.3L590 99.1l20.4-54.6c.9-2.2 2.4-3.3 4.5-3.3H627c2.1 0 3.6 1 4.5 3.3l20.2 54.6 20.2-54.6c.9-2.2 2.4-3.3 4.5-3.3h12.2c2.1 0 3.6 1 4.5 3.3l20.5 54.6 20-54.6c.9-2.2 2.4-3.3 4.5-3.3h12.3c2.1 0 3.6 1 4.5 3.3l28.4 74.8m-473.9-78h-10.1c-2.1 0-3.9 1.7-3.9 3.9V52c-5.1-7.7-15.1-13.2-26.9-13.2-22.3 0-41.4 17.6-41.4 43.3 0 26 19.2 43.5 41.3 43.5 12 0 21.7-5.5 27.1-13.2v7.2c0 2.1 1.9 3.8 3.9 3.8h10.1c2.1 0 3.8-1.7 3.8-3.8V45.2c-.1-2.2-1.8-3.9-3.9-3.9m-39 67.9c-14.7 0-25.2-12-25.2-26.9 0-15.1 10.4-26.7 25.2-26.7 14.6 0 25.2 11.6 25.2 26.7-.1 15-10.7 26.9-25.2 26.9m159.5 2.6c2.2 2.7.3 4.8-.9 5.7-7 5.3-16.3 8.2-26.4 8.2-25.5 0-42.5-18.7-42.5-43.3s17-43.5 42.5-43.5c10.1 0 19.3 2.9 26.4 8.2 1.2.9 2.9 2.7.9 5.7l-4.8 6.7c-1.9 2.6-4.1 1.9-6 .7-4.5-2.7-9.8-5-15.9-5-14.9 0-24.8 12-24.8 27.2s9.9 27.1 24.8 27.1c6.2 0 11.1-2.4 15.6-5 1.9-1 3.9-1.9 6 .9l5.1 6.4zM477.5 39c-24 0-43.1 18.8-43.1 43.3 0 24.7 19.2 43.3 43.1 43.3 24 0 43.1-18.7 43.1-43.3.1-24.4-19.1-43.3-43.1-43.3m0 70.1c-14.7 0-25.2-11.8-25.2-26.7 0-15.1 10.4-26.7 25.2-26.7 14.7 0 25.2 11.6 25.2 26.7 0 14.9-10.4 26.7-25.2 26.7M344.8 2.2c2.2 0 3.8 1.9 3.8 3.9v113.4c0 2.1-1.5 3.9-3.8 3.9h-10.1c-2.1 0-3.9-1.9-3.9-3.9V6.2c0-2.1 1.9-3.9 3.9-3.9h10.1"></path></svg>
        </div>
        
        <header class="fade-in">
            <h1>CST Quiz Challenge</h1>
            <p>Test your Connectivity System Testing knowledge!</p>
        </header>
        
        <!-- Login Form and Leaderboard -->
        <div class="login-container" id="login-container">
            <div class="card form-container fade-in" style="animation-delay: 0.2s;">
                <h2 class="card-heading">Enter Your Details</h2>
                <div class="form-group">
                    <label for="username">Full Name:</label>
                    <input type="text" id="username" class="form-input" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="employee-id">Employee ID:</label>
                    <input type="text" id="employee-id" class="form-input" placeholder="Enter your employee ID" required>
                </div>
                <div id="user-exists-message" class="error-message" style="display: none;">
                    You have already completed this quiz. Each user can only attempt once.
                </div>
                <button class="btn" id="start-btn">Start Quiz</button>
                <div style="margin-top: 15px; text-align: center;">
                    <a href="leaderboard.html" class="btn-link">View Full Leaderboard</a>
                </div>
            </div>
            
            <!-- Leaderboard Section -->
            <div class="card leaderboard-container fade-in" style="animation-delay: 0.4s;">
                <h2 class="card-heading">Top 3 Leaderboard</h2>
                <div id="leaderboard-loader" class="loader"></div>
                <div class="leaderboard-table-container" style="display: none;">
                    <table class="modern-table" id="leaderboard-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Name</th>
                                <th>Score</th>
                                <th>Percentage</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-table-body">
                            <!-- Leaderboard rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
                <div id="no-leaderboard-message" class="no-data-message" style="display: none;">
                    No quiz attempts yet. Be the first to take the quiz!
                </div>
            </div>
        </div>
        
        <!-- Quiz Content (Initially Hidden) -->
        <div class="quiz-content" id="quiz-content" style="display: none;">
            <div class="user-info" id="user-info">
                <!-- User info will be displayed here -->
            </div>

            <div id="timer-container" style="display: flex; align-items: center; justify-content: flex-end; margin-bottom: 10px; font-size: 1.1rem; font-weight: 500;">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span id="timer">0:00</span>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress" id="progress"></div>
                </div>
                <p id="question-counter">Question 1 of 10</p>
            </div>
            
            <div class="card quiz-container" id="quiz-container">
                <!-- Questions will be inserted here by JavaScript -->
            </div>
            
            <div class="controls">
                <button class="btn" id="prev-btn" disabled>Previous</button>
                <button class="btn" id="next-btn">Next</button>
                <button class="btn" id="submit-btn" style="display: none;">Submit Quiz</button>
            </div>
        </div>
        
        <div class="result-container card" id="result-container" style="display: none;">
            <h2 class="card-heading">Quiz Results</h2>
            <div id="result-user-info"></div>
            <div class="score" id="score">0/10</div>
            <div class="message" id="message"></div>
            <canvas id="confetti-canvas"></canvas>
            
            <div class="history-container" id="history-container">
                <h3>Your Quiz History</h3>
                <div class="history-table-container">
                    <table class="modern-table" id="history-table">
                        <thead>
                            <tr>
                                <th>Attempt</th>
                                <th>Score</th>
                                <th>Percentage</th>
                                <th>Date</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body">
                            <!-- History rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
                <div id="no-history-message" class="no-data-message" style="display: none;">
                    No previous quiz attempts found.
                </div>
            </div>
            
            <div class="controls">
                <button class="btn" id="restart-btn">Try Again</button>
                <button class="btn" id="view-leaderboard-btn">View Leaderboard</button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let username = "";
        let employeeId = "";
        let quizHistory = [];
        let quizStartTime;
        let timerInterval;
        // We'll load CST questions from the external file
        let questions = [];

        // Theme switcher logic
        const themeToggle = document.getElementById('theme-toggle');

        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });

        
        
        // Load CST questions
        async function loadCSTQuestions() {
            try {
                const response = await fetch('cst-questions.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                questions = await response.json();
                console.log('CST questions loaded successfully');
            } catch (error) {
                console.error('Error loading CST questions:', error);
                // Fallback to a few simple questions if loading fails
                questions = [
                  {
                    "id": 1,
                    "question": "What does CST stand for?",
                    "options": ["Computer System Testing", "Connectivity System Testing", "Communication Software Technology", "Connection Security Testing"],
                    "correctAnswer": "Connectivity System Testing"
                  },
                  {
                    "id": 2,
                    "question": "Which protocol is commonly used for wireless connectivity testing?",
                    "options": ["HTTP", "TCP/IP", "802.11", "SMTP"],
                    "correctAnswer": "802.11"
                  },
                  {
                    "id": 3,
                    "question": "What is the purpose of a network sniffer in connectivity testing?",
                    "options": ["To block malicious traffic", "To capture and analyze network packets", "To increase network speed", "To connect multiple networks"],
                    "correctAnswer": "To capture and analyze network packets"
                  }
                ];
                console.log('Using fallback questions');
            }
        }
        
        let selectedQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        
        // DOM elements
        const loginContainer = document.getElementById('login-container');
        const quizContent = document.getElementById('quiz-content');
        const usernameInput = document.getElementById('username');
        const employeeIdInput = document.getElementById('employee-id');
        const startBtn = document.getElementById('start-btn');
        const userInfoElement = document.getElementById('user-info');
        const resultUserInfoElement = document.getElementById('result-user-info');
        const quizContainer = document.getElementById('quiz-container');
        const progressBar = document.getElementById('progress');
        const questionCounter = document.getElementById('question-counter');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const resultContainer = document.getElementById('result-container');
        const scoreElement = document.getElementById('score');
        const messageElement = document.getElementById('message');
        const restartBtn = document.getElementById('restart-btn');
        const viewLeaderboardBtn = document.getElementById('view-leaderboard-btn');
        
        // Initialize the quiz
        function initializeQuiz() {
            // Select 10 random questions
            selectedQuestions = getRandomQuestions(questions, 10);
            
            // Initialize user answers array with nulls
            userAnswers = Array(selectedQuestions.length).fill(null);
            
            // Display the first question
            displayQuestion(currentQuestionIndex);
            
            // Update progress
            updateProgress();
        }
        
        // Get random questions from the pool
        function getRandomQuestions(allQuestions, count) {
            const shuffled = [...allQuestions].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }
        
        // Display a question
        function displayQuestion(index) {
            const question = selectedQuestions[index];
            
            quizContainer.innerHTML = `
                <div class="question-container fade-in">
                    <div class="question">${question.question}</div>
                    <div class="options">
                        ${question.options.map((option, i) => `
                            <button class="option ${userAnswers[index] === option ? 'selected' : ''}" 
                                    data-option="${option}">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // Add event listeners to options
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', () => selectOption(option.dataset.option));
            });
            
            // Update buttons
            prevBtn.disabled = index === 0;
            
            if (index === selectedQuestions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
            
            // Update question counter
            questionCounter.textContent = `Question ${index + 1} of ${selectedQuestions.length}`;
        }
        
        // Select an option
        function selectOption(option) {
            userAnswers[currentQuestionIndex] = option;
            
            // Update UI to show selected option
            document.querySelectorAll('.option').forEach(btn => {
                btn.classList.remove('selected');
                if (btn.dataset.option === option) {
                    btn.classList.add('selected');
                }
            });
        }
        
        // Update progress bar
        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / selectedQuestions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        // Calculate score
        function calculateScore() {
            let score = 0;
            
            selectedQuestions.forEach((question, index) => {
                if (userAnswers[index] === question.correctAnswer) {
                    score++;
                }
            });
            
            return score;
        }
        
        // Show results
        function showResults() {
            const score = calculateScore();
            const total = selectedQuestions.length;
            const percentage = (score / total) * 100;
            const timeTaken = new Date() - quizStartTime;

            // Stop the timer
            clearInterval(timerInterval);

            // Format timeTaken into a readable string (MM:SS)
            const minutes = Math.floor(timeTaken / 60000);
            const seconds = ((timeTaken % 60000) / 1000).toFixed(0);
            const formattedTime = `${minutes}:${(seconds < 10 ? '0' : '')}${seconds}`;

            // Display user info in results
            resultUserInfoElement.innerHTML = `<strong>Name:</strong> ${username} | <strong>Employee ID:</strong> ${employeeId}`;
            
            scoreElement.textContent = `${score}/${total}`;
            
            // Set message based on score
            if (percentage >= 90) {
                messageElement.textContent = 'Excellent! You\'re a CST expert!';
            } else if (percentage >= 70) {
                messageElement.textContent = 'Great job! You have solid connectivity testing knowledge!';
            } else if (percentage >= 50) {
                messageElement.textContent = 'Good effort! Keep learning more about connectivity systems.';
            } else {
                messageElement.textContent = 'Keep studying! CST knowledge improves with practice.';
            }
            
            // Save quiz result to server
            saveQuizResult(score, total, formattedTime);
            
            // Display quiz history
            displayQuizHistory();
            
            // Hide quiz and show results
            quizContent.style.display = 'none';
            resultContainer.style.display = 'block';
        }
        
        // Event listeners
        prevBtn.addEventListener('click', () => {
            currentQuestionIndex--;
            displayQuestion(currentQuestionIndex);
            updateProgress();
        });
        
        nextBtn.addEventListener('click', () => {
            currentQuestionIndex++;
            displayQuestion(currentQuestionIndex);
            updateProgress();
        });
        
        submitBtn.addEventListener('click', showResults);
        
        restartBtn.addEventListener('click', () => {
            // Return to login screen instead of restarting quiz
            // (since users can only take the quiz once)
            resultContainer.style.display = 'none';
            loginContainer.style.display = 'flex';
            
            // Clear form fields
            usernameInput.value = '';
            employeeIdInput.value = '';
            
            // Update leaderboard
            updateLeaderboard();
        });

        viewLeaderboardBtn.addEventListener('click', () => {
            window.location.href = 'leaderboard.html';
        });
        
        
        // Start button event listener
        startBtn.addEventListener('click', async () => {
            // Validate inputs
            if (usernameInput.value.trim() === '') {
                usernameInput.classList.add('error');
                return;
            }
            
            if (employeeIdInput.value.trim() === '') {
                employeeIdInput.classList.add('error');
                return;
            }
            
            // Store user information
            username = usernameInput.value.trim();
            employeeId = employeeIdInput.value.trim();
            
            try {
                // Check if user has already taken the quiz (by employee ID only)
                const response = await fetch(`/api/user/${employeeId}`);
                const data = await response.json();
                
                if (data.exists) {
                    // Show error message if user has already taken the quiz
                    document.getElementById('user-exists-message').style.display = 'block';
                    document.getElementById('user-exists-message').textContent = 
                        'This Employee ID has already been used. Each employee can only attempt once.';
                    return;
                }
                
                // Display user info in the quiz
                userInfoElement.innerHTML = `<strong>Name:</strong> ${username} | <strong>Employee ID:</strong> ${employeeId}`;
                
                // Hide login form and show quiz
                loginContainer.style.display = 'none';
                quizContent.style.display = 'block';
                
                // Reset question index to ensure we start from question 1
                currentQuestionIndex = 0;
                
                // Set start time
                quizStartTime = new Date();

                // Initialize the quiz
                initializeQuiz();
                
                // Start the timer
                startTimer();
                
            } catch (error) {
                console.error('Error checking user:', error);
                alert('There was an error connecting to the server. Please try again.');
            }
        });
        
        // Input validation - remove error class on input
        usernameInput.addEventListener('input', () => {
            usernameInput.classList.remove('error');
            // Only hide the error message when changing username if it's not an employee ID conflict
            const errorMsg = document.getElementById('user-exists-message');
            if (errorMsg.textContent.indexOf('This Employee ID has already been used by') === -1) {
                errorMsg.style.display = 'none';
            }
        });
        
        employeeIdInput.addEventListener('input', () => {
            employeeIdInput.classList.remove('error');
            // Always hide error message when employee ID changes
            document.getElementById('user-exists-message').style.display = 'none';
        });
        
        function startTimer() {
            const timerElement = document.getElementById('timer');
            quizStartTime = new Date();

            timerInterval = setInterval(() => {
                const now = new Date();
                const timeDifference = now - quizStartTime;

                const minutes = Math.floor(timeDifference / 60000);
                const seconds = ((timeDifference % 60000) / 1000).toFixed(0);

                timerElement.textContent = `${minutes}:${(seconds < 10 ? '0' : '')}${seconds}`;
            }, 1000);
        }

        // Server API Functions
        
        // Save quiz result to server
        async function saveQuizResult(score, total, timeTaken) {
            try {
                // Create a result object
                const result = {
                    username: username,
                    employeeId: employeeId,
                    score: score,
                    total: total,
                    percentage: ((score / total) * 100).toFixed(1),
                    timeTaken: timeTaken
                };
                
                // Send score to server
                const response = await fetch('/api/scores', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(result)
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('Error saving score:', errorData);
                    return;
                }
                
                // Update leaderboard
                updateLeaderboard();
            } catch (error) {
                console.error('Error saving score:', error);
            }
        }
        
        // Update leaderboard with current results from server
        async function updateLeaderboard() {
            const loader = document.getElementById('leaderboard-loader');
            const tableContainer = document.querySelector('.leaderboard-table-container');

            loader.style.display = 'block';
            tableContainer.style.display = 'none';

            try {
                const leaderboardTableBody = document.getElementById('leaderboard-table-body');
                const noLeaderboardMessage = document.getElementById('no-leaderboard-message');
                
                // Get leaderboard data from server
                const response = await fetch('/api/leaderboard');
                const data = await response.json();
                const allResults = data.scores || [];
                
                // Clear previous leaderboard
                leaderboardTableBody.innerHTML = '';
                
                if (allResults.length > 0) {
                    // Sort by percentage (highest first)
                    const sortedResults = [...allResults].sort((a, b) => 
                        parseFloat(b.percentage) - parseFloat(a.percentage)
                    );
                    
                    // Create table rows for top 3 scores only
                    sortedResults.slice(0, 3).forEach((result, index) => {
                        const row = document.createElement('tr');
                        
                        // Add 'top-score' class to the top 3 scores
                        if (index < 3) {
                            row.classList.add('top-score');
                        }
                        
                        row.innerHTML = `
                            <td>${index + 1}</td>
                            <td>${result.username}</td>
                            <td>${result.score}/${result.total}</td>
                            <td>${result.percentage}%</td>
                            <td>${result.timeTaken || 'N/A'}</td>
                        `;
                        
                        leaderboardTableBody.appendChild(row);
                    });
                    
                    // Add a message showing total participants if more than 3
                    if (sortedResults.length > 3) {
                        const totalRow = document.createElement('tr');
                        totalRow.innerHTML = `
                            <td colspan="4" style="text-align: center; font-style: italic;">
                                ${sortedResults.length} total participants
                            </td>
                        `;
                        leaderboardTableBody.appendChild(totalRow);
                    }
                    
                    // Show table, hide no leaderboard message
                    tableContainer.style.display = 'block';
                    noLeaderboardMessage.style.display = 'none';
                } else {
                    // Hide table, show no leaderboard message
                    tableContainer.style.display = 'none';
                    noLeaderboardMessage.style.display = 'block';
                }
            } catch (error) {
                console.error('Error updating leaderboard:', error);
                noLeaderboardMessage.textContent = 'Failed to load leaderboard.';
                noLeaderboardMessage.style.display = 'block';
            } finally {
                loader.style.display = 'none';
            }
        }
        
        // Display quiz history in the results page
        function displayQuizHistory() {
            const historyTableBody = document.getElementById('history-table-body');
            const noHistoryMessage = document.getElementById('no-history-message');
            
            // Clear previous history
            historyTableBody.innerHTML = '';
            
            // Sort history by date (newest first)
            const sortedHistory = [...quizHistory].sort((a, b) => 
                new Date(b.date) - new Date(a.date)
            );
            
            if (sortedHistory.length > 0) {
                // Create table rows for each attempt
                sortedHistory.forEach((result, index) => {
                    const row = document.createElement('tr');
                    const date = new Date(result.date);
                    const formattedDate = `${date.toLocaleDateString()} ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
                    
                    row.innerHTML = `
                        <td>${sortedHistory.length - index}</td>
                        <td>${result.score}/${result.total}</td>
                        <td>${result.percentage}%</td>
                        <td>${formattedDate}</td>
                        <td>${result.timeTaken || 'N/A'}</td>
                    `;
                    
                    historyTableBody.appendChild(row);
                });
                
                // Show table, hide no history message
                document.querySelector('.history-table-container').style.display = 'block';
                noHistoryMessage.style.display = 'none';
            } else {
                // Hide table, show no history message
                document.querySelector('.history-table-container').style.display = 'none';
                noHistoryMessage.style.display = 'block';
            }
        }
        
        // Create bubbles function
        function createBubbles() {
            const bubbleContainer = document.getElementById('bubble-container');
            const bubbleCount = 80; // Number of bubbles
            
            // Clear any existing bubbles
            bubbleContainer.innerHTML = '';
            
            for (let i = 0; i < bubbleCount; i++) {
                const bubble = document.createElement('div');
                bubble.classList.add('bubble');
                
                // Random size between 20px and 120px
                const size = Math.random() * 100 + 20;
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                
                // Random starting position
                const startPositionX = Math.random() * 100;
                bubble.style.left = `${startPositionX}%`;
                
                // Random horizontal drift between -100px and 100px
                const drift = Math.random() * 200 - 100;
                bubble.style.setProperty('--bubble-drift', `${drift}px`);
                
                // Random opacity between 0.1 and 0.3
                const opacity = Math.random() * 0.2 + 0.1;
                bubble.style.setProperty('--bubble-opacity', opacity);
                
                // Random animation duration between 15s and 40s
                const duration = Math.random() * 25 + 15;
                bubble.style.animationDuration = `${duration}s`;
                
                // Random delay so they don't all start at once
                const delay = Math.random() * 30;
                bubble.style.animationDelay = `${delay}s`;
                
                bubbleContainer.appendChild(bubble);
            }
        }
        
        // Initialize leaderboard, load questions, and create bubbles on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadCSTQuestions();
            updateLeaderboard();
            createBubbles();
            initializeTheme();
        });
    </script>

      <div style="
        position: fixed;
        bottom: 10px;
        right: 10px;
        font-family: Arial, sans-serif;
        font-size: 12px;
        color: #999999;
        opacity: 0.7;
        pointer-events: none;
        z-index: 9999;
      ">
      </div>
      <script>
        // This script is only for preview purposes and should be removed in production
        // We're allowing the leaderboard link and theme toggle to work
        document.addEventListener('DOMContentLoaded', function() {
          // Prevent default action on buttons except theme toggle and view leaderboard
          document.querySelectorAll('button:not(#theme-toggle)').forEach(button => {
            button.addEventListener('click', function(e) {
              if (e.currentTarget.id !== 'view-leaderboard-btn') {
                e.preventDefault();
                e.stopPropagation();
                return false;
            }
            });
          });
          
          // Prevent form submissions
          document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', function(e) {
              e.preventDefault();
              e.stopPropagation();
              return false;
            });
          });
        });
      </script>
    </body>
</html>